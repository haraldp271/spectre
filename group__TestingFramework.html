<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.8.13"/>
    <style>
        /*!
         * IE10 viewport hack for Surface/desktop Windows 8 bug
         * Copyright 2014-2015 Twitter, Inc.
         * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
         */
        @-webkit-viewport { width: device-width; }
        @-moz-viewport    { width: device-width; }
        @-ms-viewport     { width: device-width; }
        @-o-viewport      { width: device-width; }
        @viewport         { width: device-width; }
      </style>
  <title>SpECTRE: Testing Framework</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "color.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
});
MathJax.Hub.Config({
    tex2jax: {inlineMath: [['^^','^^'], ['\\(', '\\)']]}
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="bootstrap.min.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="bootstrap.min.js"></script>
  <script type="text/javascript" src="spectre.js"></script>
  </head>
  <body>
  <div id="top" class="navbar-fixed-top"><!-- do not remove this div, it is closed by doxygen! -->
  <!-- BEGIN TITLEAREA -->
  <div id="titlearea">
  <script type="text/javascript">
  var searchBox = new SearchBox("searchBox", "search",false,'Search');
  </script>
  <div id="main-nav">
    <ul class="sm sm-dox" id="main-menu">
      <li>
      <a href="https://github.com/sxs-collaboration/spectre" target="_blank">
      SpECTRE &#160;
        <span id="projectnumber">v0.0.0</span>
      </a>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-book"></i><span>Documentation</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 135px;">
            <a href="index.html">
            <i class="octicon octicon-book"></i><span>Documentation</span></a>
          </li>
          <li style="min-width: 135px;">
            <a href="tutorials.html">
              <i class="octicon octicon-mortar-board"></i><span>Tutorials</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="dev_guide.html">
              <i class="octicon octicon-gist-secret"></i><span>Dev Guide</span>
            </a>
          </li>
        </ul>
      </li>
      <li class="dropdown" style="min-width: 150px;">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-code"></i>
              <span>Reference</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 130px;">
            <a href="modules.html">
              <i class="octicon octicon-code"></i>
              <span>Reference</span>
            </a>
          </li>
          <li style="min-width: 130px;">
            <a href="namespaces.html">
              <i class="octicon octicon-gist"></i>
              <span>Namespaces</span>
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a href="files.html">
          <i class="octicon octicon-file-directory"></i><span>Files</span>
        </a>
      </li>
      <!--The Search <li> is added by doxygen later-->
    </ul>
  </div><!-- main-nav -->
  </div><!-- titlearea -->
  <!-- window showing the filter options -->
  <div id="MSearchSelectWindow"  style="position: fixed;"
       onmouseover="return searchBox.OnSearchSelectShow()"
       onmouseout="return searchBox.OnSearchSelectHide()"
       onkeydown="return searchBox.OnSearchSelectKey(event)">
  </div>
  <!-- iframe showing the search results (closed by default) -->
  <div id="MSearchResultsWindow"  style="position: fixed;">
  <iframe src="javascript:void(0)" frameborder="0"
          name="MSearchResults" id="MSearchResults">
  </iframe>
  </div><!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Testing Framework</div>  </div>
</div><!--header-->
<div class="contents">

<p>Classes, functions, macros, and instructions for developing tests.  
<a href="#details">More...</a></p>
<p>Classes, functions, macros, and instructions for developing tests. </p>
<h3>Details</h3>
<p>SpECTRE uses the testing framework <a href="https://github.com/philsquared/Catch">Catch</a>. Catch supports a variety of different styles of tests including BDD and fixture tests. The file <code>cmake/SpectreAddCatchTests.cmake</code> parses the source files and adds the found tests to ctest with the correct properties specified by tags and attributes.</p>
<h3>Usage</h3>
<p>To run the tests, type <code>ctest</code> in the build directory. You can specify a regex to match the test name using <code>ctest -R Unit.Blah</code>, or run all tests with a certain tag using <code>ctest -L tag</code>.</p>
<h3>Comparing double-precision results</h3>
<p>To compare two floating-point numbers that may differ by round-off, use the helper object <code>approx</code>. This is an instance of Catch's comparison class <code>Approx</code> in which the relative tolerance for comparisons is set to roughly \(10^{-14}\) (i.e. <code>std\:\:numeric_limits&lt;double&gt;\:\:epsilon()*100</code>). When possible, we recommend using <code>approx</code> for fuzzy comparisons as follows: </p>
<h3>Example</h3>
<div class="fragment"><div class="line">  CHECK(<a class="codeRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/numeric/math/sin.html">sin</a>(M_PI / 4.0) == approx(<a class="codeRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/numeric/math/cos.html">cos</a>(M_PI / 4.0)));</div></div><!-- fragment --><p> For checks that need more control over the precision (e.g. an algorithm in which round-off errors accumulate to a higher level), we recommend using the <code>approx</code> helper with a one-time tolerance adjustment. A comment should explain the reason for the adjustment: </p>
<h3>Example</h3>
<div class="fragment"><div class="line">  <span class="comment">// This check needs tolerance 1e-12 for X reason.</span></div><div class="line">  CHECK(1.0 == approx(1.0 + 5e-13).epsilon(1e-12));</div></div><!-- fragment --><p> For tests in which the same precision adjustment is re-used many times, a new helper object can be created from Catch's <code>Approx</code> with a custom precision: </p>
<h3>Example</h3>
<div class="fragment"><div class="line">  <span class="comment">// The checks in this test need tolerance 1d-12 for X reason.</span></div><div class="line">  Approx my_approx = Approx::custom().epsilon(1e-12);</div><div class="line">  CHECK(1.0 == my_approx(1.0 + 5e-13));</div><div class="line">  CHECK(1.0 != my_approx(1.0 + 5e-12));</div></div><!-- fragment --><p> Note: We provide the <code>approx</code> object because Catch's <code>Approx</code> defaults to a very loose tolerance (<code>std\:\:numeric_limits&lt;float&gt;\:\:epsilon()*100</code>, or roughly \(10^{-5}\) relative error), and so is poorly-suited to checking many numerical algorithms that rely on double-precision accuracy. By providing a tighter tolerance with <code>approx</code>, we avoid having to redefine the tolerance in every test.</p>
<h3>Attributes</h3>
<p>Attributes allow you to modify properties of the test. Attributes are specified as follows: </p><div class="fragment"><div class="line"><span class="comment">// [[TimeOut, 10]]</span></div><div class="line"><span class="comment">// [[ErrorRegex, The error message expected from the test]]</span></div><div class="line">SPECTRE_TEST_CASE(<span class="stringliteral">&quot;Unit.Blah&quot;</span>, <span class="stringliteral">&quot;[Unit]&quot;</span>) {</div></div><!-- fragment --><p>Available attributes are:</p>
<table class="doxtable">
<tr>
<th>Attribute </th><th>Description   </th></tr>
<tr>
<td>TimeOut  </td><td>override the default timeout and set the timeout to N seconds. This should be set very sparingly since unit tests are designed to be short. If your test is too long you should consider testing smaller portions of the code if possible, or writing an integration test instead.   </td></tr>
<tr>
<td>ErrorRegex  </td><td>When testing failure modes the exact error message must be tested, not just that the test failed. Since the string passed is a regular expression you must escape any regex tokens. For example, to match "some (word) and" you must specify the string "some \(word\) and".   </td></tr>
</table>
<h3>Example</h3>
<p>snippet Test_H5.cpp willfail_example_for_dev_doc</p>
<h3>Testing static assert</h3>
<p>You are able to test that a <code>static_assert</code> is being triggered using the compilation failure test framework. When creating a new <code>static_assert</code> test you must be sure to not have it in the same file as the runtime tests since the file will not compile. The new file, say <code>Test_StaticAssertDataBox.cpp</code> must be added to the <code>SPECTRE_COMPILATION_TESTS</code> CMake variable, not <code>SPECTRE_TESTS</code>. Here is an example of how to write a compilation failure test:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifdef COMPILATION_TEST_TEST_FRAMEWORK_WORKS</span></div><div class="line"><span class="comment">// [[TAGS: unit, CompilationTest]]</span></div><div class="line"></div><div class="line"><span class="comment">// [[COMPILER: all REGEX: Testing compilation failure tests]]</span></div><div class="line"></div><div class="line">static_assert(<span class="keyword">false</span>, <span class="stringliteral">&quot;Testing compilation failure tests&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main() {}</div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">FILE_IS_COMPILATION_TEST</div></div><!-- fragment --><p> Each individual test must be inside an <code>#ifdef COMPILATION_TEST_.*</code> block and each compilation test <code>cpp</code> file must contain <code>FILE_IS_COMPILATION_TEST</code> outside of any <code>#ifdef</code>s and at the end of the file.</p>
<p>Specific compiler versions can be specified for which the regex changes. That is, the compiler version specified and all versions newer than that will use the regex, until a newer compiler version is specified. For example, see the below code prints a different static_assert for pre-GCC 6 and GCC 6 and newer.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifdef COMPILATION_TEST_TEST_DIFFERENT_COMPILERS</span></div><div class="line"><span class="comment">// [[TAGS: unit, CompilationTest]]</span></div><div class="line"></div><div class="line"><span class="comment">// [[COMPILER: GNU:0.0.0 REGEX: static assertion failed: assert with GCC 5]]</span></div><div class="line"><span class="comment">// [[COMPILER: GNU:6.0.0 REGEX: static assertion failed: assert with GCC 6 or</span></div><div class="line"><span class="comment">// newer]]</span></div><div class="line"><span class="comment">// [[COMPILER: Clang REGEX: static_assert failed \&quot;assert with Clang\&quot;]]</span></div><div class="line"><span class="comment">// [[COMPILER: AppleClang REGEX: static_assert failed \&quot;assert with</span></div><div class="line"><span class="comment">// AppleClang\&quot;]]</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef __APPLE__</span></div><div class="line">static_assert(<span class="keyword">false</span>, <span class="stringliteral">&quot;assert with AppleClang&quot;</span>);</div><div class="line"><span class="preprocessor">#else  // __APPLE__</span></div><div class="line"><span class="preprocessor">#ifdef __clang__</span></div><div class="line">static_assert(<span class="keyword">false</span>, <span class="stringliteral">&quot;assert with Clang&quot;</span>);</div><div class="line"><span class="preprocessor">#else  // __clang__</span></div><div class="line"><span class="preprocessor">#if __GNUC__ &lt; 6</span></div><div class="line">static_assert(<span class="keyword">false</span>, <span class="stringliteral">&quot;assert with GCC 5&quot;</span>);</div><div class="line"><span class="preprocessor">#else   // __GNUC__ &lt; 6</span></div><div class="line">static_assert(<span class="keyword">false</span>, <span class="stringliteral">&quot;assert with GCC 6 or newer&quot;</span>);</div><div class="line"><span class="preprocessor">#endif  // __GNUC__ &lt; 6</span></div><div class="line"><span class="preprocessor">#endif  // __clang__</span></div><div class="line"><span class="preprocessor">#endif  // __APPLE__</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main() {}</div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --> <h3>Debugging Tests in GDB or LLDB</h3>
<p>Several tests fail intentionally at the executable level to test error handling like ASSERT statements in the code. CTest is aware of which should fail and passes them. If you want to debug an individual test in a debugger you need to run a single test using the RunTests executable (in dg-charm-build/bin/RunTests) you must specify the name of the test as the first argument. For example, if you want to run just the "Unit.Gradient" test you can run <code>./bin/RunTests Unit.Gradient</code>. If you are using a debugger launch the debugger, for example if you're using LLDB then run <code>lldb ./bin/RunTests</code> and then to run the executable inside the debugger use <code>run Unit.Gradient</code> inside the debugger. </p>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; Copyright 2017
<a href="https://black-holes.org">SXS Collaboration</a>,
<a href="LICENSE.txt" target="_blank">
<span class="hidden-xs">Distributed under the</span>
MIT License</a>
</small></address>
</body>
</html>
